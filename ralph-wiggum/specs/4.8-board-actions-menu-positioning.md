# Spec: Phase 4.8 - BoardActionsMenu Positioning Fix

> **Goal**: Ensure BoardActionsMenu works correctly in collapsed sidebar icon-only mode.
> **Context**: The actions menu is positioned as a sibling to `SidebarMenuButton` rather than using the `SidebarMenuAction` slot pattern.
> **Issue Reference**: `docs/phase4-board-management-issues.md#M3`

## 1. Problem Statement

Current structure in `app-sidebar.tsx`:
```tsx
<SidebarMenuItem key={board.id} className='group/board'>
  <SidebarMenuButton ...>
    <Link href={...}>...</Link>
  </SidebarMenuButton>
  <BoardActionsMenu ... />  {/* Sibling, not using SidebarMenuAction */}
</SidebarMenuItem>
```

The `group/board` class properly scopes hover states, but this might cause:
- Incorrect positioning in collapsed/icon-only mode
- Dropdown positioning issues when sidebar is narrow
- Accessibility concerns if slot pattern provides semantic benefits

## 2. Requirements

### 2.1 UX Testing (Required First)
Before any code changes, test current behavior:
- [ ] Collapse sidebar to icon-only mode
- [ ] Hover over board items - verify actions menu appears correctly
- [ ] Click actions menu - verify dropdown positions correctly
- [ ] Test keyboard navigation

**If all tests pass**: Document as intentional and close issue.
**If issues found**: Proceed with fix below.

### 2.2 Refactor to SidebarMenuAction (If Needed)
- **File**: `OpenKanban/src/components/layout/app-sidebar.tsx`
- **Pattern**: Use shadcn/ui's `SidebarMenuAction` slot component
- **Reference**: shadcn/ui sidebar documentation

**Current**:
```tsx
<SidebarMenuItem key={board.id} className='group/board'>
  <SidebarMenuButton asChild tooltip={board.name} isActive={isBoardActive}>
    <Link href={...}>
      <IconLayoutKanban className='h-4 w-4' />
      <span>{board.name}</span>
    </Link>
  </SidebarMenuButton>
  <BoardActionsMenu
    boardId={board.id}
    boardName={board.name}
    projectId={projectId}
  />
</SidebarMenuItem>
```

**Proposed** (if issues found):
```tsx
<SidebarMenuItem key={board.id}>
  <SidebarMenuButton asChild tooltip={board.name} isActive={isBoardActive}>
    <Link href={...}>
      <IconLayoutKanban className='h-4 w-4' />
      <span>{board.name}</span>
    </Link>
  </SidebarMenuButton>
  <SidebarMenuAction asChild>
    <BoardActionsMenu
      boardId={board.id}
      boardName={board.name}
      projectId={projectId}
    />
  </SidebarMenuAction>
</SidebarMenuItem>
```

### 2.3 Update BoardActionsMenu (If Needed)
- May need to adjust component to work as child of `SidebarMenuAction`
- Might need to use `asChild` prop pattern from Radix

## 3. Definition of Done
- [ ] UX testing checklist completed
- [ ] Actions menu visible and functional in collapsed mode
- [ ] Dropdown positions correctly in all sidebar states
- [ ] Keyboard navigation works
- [ ] `group/board` class removed if not needed after refactor
- [ ] `npm run build` passes
- [ ] `npm run lint` passes

## 4. Implementation Plan
1. Run UX testing checklist manually
2. Document findings
3. If issues: Investigate `SidebarMenuAction` from shadcn/ui
4. Refactor `BoardActionsMenu` usage
5. Update `BoardActionsMenu` component if needed
6. Re-run UX testing

## 5. Estimated Effort
30-60 minutes (if refactor needed)

## 6. UX Testing Checklist
```markdown
### Collapsed Sidebar Test
- [ ] Sidebar collapses to icon-only mode
- [ ] Board icons visible
- [ ] Hover shows tooltip with board name

### Actions Menu Test
- [ ] Three-dot menu visible on hover (or always visible?)
- [ ] Menu dropdown opens in correct direction
- [ ] Menu items (Rename, Delete) are clickable
- [ ] Dialogs open correctly from dropdown

### Positioning Test
- [ ] Dropdown doesn't overflow viewport
- [ ] Dropdown doesn't get cut off by sidebar edge
- [ ] Position adjusts based on available space

### Keyboard Test
- [ ] Tab navigates to actions menu
- [ ] Enter opens dropdown
- [ ] Arrow keys navigate dropdown items
- [ ] Escape closes dropdown
```
