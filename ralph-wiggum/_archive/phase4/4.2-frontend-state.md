# Spec: Phase 4.2 - Frontend State & API

> **Goal**: Update the frontend API client and React hooks to support board filtering and deletion.
> **Context**: The backend now supports `parentId` filtering. The frontend needs to consume this.

## 1. Requirements

### 1.1 Frontend API
- **File**: `OpenKanban/src/features/kanban/api.ts`
- **Update**: `fetchBoards`
    - Update signature to accept `filters?: { parentId?: string }`.
    - Append `parentId` to URL search params if present.
- **Update**: `CreateBoardInput`
    - Add `filters?: { parentId?: string }` to the type definition.
- **Add**: `deleteBoard(id: string): Promise<{ id: string }>`
    - Send `DELETE /api/boards/[id]`.
    - Handle errors (404, 500) using `ApiError`.
    - Return object with deleted id.

### 1.2 Query Keys
- **File**: `OpenKanban/src/lib/query-keys.ts`
- **Update**: Add `boards` to the factory.
    ```typescript
    boards: (parentId?: string) => parentId ? ['boards', { parentId }] : ['boards'],
    ```

### 1.3 Hooks
- **File**: `OpenKanban/src/features/boards/hooks/use-boards.ts` (Create)
    - Hook: `useBoards(projectId: string)`
    - Usage: `useQuery({ queryKey: queryKeys.boards(projectId), queryFn: () => fetchBoards({ parentId: projectId }) })`.
- **File**: `OpenKanban/src/features/boards/hooks/use-board-mutations.ts` (Create)
    - Hook: `useCreateBoard()` -> Invalidates `['boards']` (all boards queries).
    - Hook: `useUpdateBoard()` -> Invalidates `['boards']`.
    - Hook: `useDeleteBoard()` -> Invalidates `['boards']`.
    - **Note**: Using broad invalidation (`['boards']`) is safer and simpler for now than exact matching. Use `queryClient.invalidateQueries({ queryKey: ['boards'] })`.

## 2. Definition of Done
- [ ] `fetchBoards` calls the correct URL with query params.
- [ ] `useBoards` hook successfully fetches filtered data.
- [ ] `useDeleteBoard` successfully deletes a board and invalidates cache.
- [ ] No lint errors.

## 3. Implementation Plan
1.  Update `src/features/kanban/api.ts`.
2.  Update `src/lib/query-keys.ts`.
3.  Create `src/features/boards/hooks/use-boards.ts`.
4.  Create `src/features/boards/hooks/use-board-mutations.ts`.
5.  Verify type safety.
